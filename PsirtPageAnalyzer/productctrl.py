import json
from .models import ProdAndVulRelationship, Product


class ProductCtrl():
    def get_prod_vul_relationship_by_prod(self, product_name):
        product = Product.objects.get(name=product_name)
        pvrs = ProdAndVulRelationship.objects.filter(product=product)
        prodVulMap = {'product': product_name, 'vulList': [r.vul.to_json() for r in pvrs]}
        return json.dumps(prodVulMap)
