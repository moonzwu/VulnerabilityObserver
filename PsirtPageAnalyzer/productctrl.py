import json
from collections import namedtuple
from .models import ProdAndVulRelationship, Product

class ProductCtrl():
    def getTheProductAndVulMapByProduct(self, product):
        pvrs = ProdAndVulRelationship.objects.filter(product=product)
        prodVulMap = {'product':product.name, 'vulList':[r.vul.to_json() for r in pvrs]}
        return json.dumps(prodVulMap)


    def getAllProducts(self):
        return Product.objects.all()