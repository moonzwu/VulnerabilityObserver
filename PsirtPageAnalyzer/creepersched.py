import time
import datetime
from apscheduler.schedulers.background import BackgroundScheduler
from PsirtPageAnalyzer.pagecreeper import PsirtPageCreeper

class CreeperScheduler():
    index = 0

    def creep_job(self):
        self.index += 1
        print('Start the ', self.index, ' round creep at ', datetime.datetime.now() )
        start_time = time.time()
        if PsirtPageCreeper().creep():
            print('Creep job running succeed.')
        else:
            print('Creep job has failed.')
        print('Total cost is ', time.time() - start_time)
        print('The creep job end.')

    def start_creep_scheduler(self):
        sched = BackgroundScheduler()
        sched.add_job(self.creep_job, 'interval', hours=8)
        sched.start()