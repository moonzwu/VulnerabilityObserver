import json
from .models import BUAndProdRelationship, BusinessUnit


class BusinessUnitCtrl():
    def get_relationships_by_bu(self, bu_name):
        bu = BusinessUnit.objects.get(name=bu_name)
        bprs = BUAndProdRelationship.objects.filter(bu=bu)
        bu_prod_map = {'bu': bu_name, 'prodList': [r.product.to_json() for r in bprs]}
        return json.dumps(bu_prod_map)

    def get_all_bus(self):
        bus = BusinessUnit.objects.all()
        bu_list = [bu.to_json() for bu in bus]
        return json.dumps(bu_list)
