from django.conf.urls import url

from . import views
from . import apis

urlpatterns = [
    url(r'^$', views.index, name='index'),
    url(r'^api/bsus$', apis.business_units, name='business unit'),
    url(r'^api/bsus/(?P<bu_name>(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4}))/products$', apis.products_by_bu, name='product'),
    url(r'^api/vuls$', apis.vulnerabilities, name='vulnerability'),
    url(r'^api/product/(?P<prod_name>(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4}))/vuls$', apis.vuls_by_product, name='get vulnerabilities'),
    url(r'^api/start$', apis.start_scheduler, name='trigger re-analyzer PSIRT page'),

]