import json
from collections import namedtuple
from .models import BUAndProdRelationship


class BusinessUnitCtrl():
    def getTheBUAndProductMap(self):
        buProdMap = {}
        NamedBP = namedtuple('NamedBP', ['bu', 'prodList'])
        buprs = BUAndProdRelationship.objects.all()
        for r in buprs:
            if r.bu.name in buProdMap:
                buProdMap[r.bu.name].prodList.append(r.product)
            else:
                buProdMap[r.bu.name] = NamedBP(r.bu, [r.product])

        return buProdMap